--- net-snmp-5.4.2.1-dev/configure.in	2009-01-22 00:49:25.233782506 +0200
+++ net-snmp-5.4.2.1-dev/configure.in	2009-01-22 20:00:37.030183514 +0200
@@ -310,6 +310,12 @@
 AC_ARG_ENABLE(efence,,
 	AC_MSG_ERROR([ Invalid option. Use --with-efence/--without-efence instead ]) )
 
+AC_ARG_WITH(nl,
+[  --with-nl                   Look for and use libnl (linux only).],
+      use_nl="$withval")
+AC_ARG_ENABLE(nl,,
+	AC_MSG_ERROR([ Invalid option. Use --with-nl/--without-nl instead ]) )
+
 tryrsaref=no
 AC_ARG_WITH(rsaref,
 [  --with-rsaref=PATH              Look for librsaref in PATH/lib.],
@@ -2664,6 +2670,21 @@
     AC_CHECK_LIB(efence, EF_Exit)
 fi
 
+if test "x$use_nl" != "xno"; then
+    case $target_os in
+    linux*) # Check for libnl (linux)
+	AC_CHECK_HEADERS(netlink/netlink.h,
+	    AC_CHECK_LIB(nl, nl_connect, [
+		AC_DEFINE_UNQUOTED(HAVE_NL, "1", [have libnl])
+		LIBNL_LIBS="-lnl"
+		LIBNL="Yes"
+	    ])
+	)
+    ;;
+    esac
+fi
+
+
 # Checks for libraries.
 # AC_CHECK_LIB(des, main)
 # AC_CHECK_LIB(m, asin)
